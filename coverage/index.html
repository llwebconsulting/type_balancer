<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>Code coverage for Type balancer</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src='./assets/0.13.1/application.js' type='text/javascript'></script>
    <link href='./assets/0.13.1/application.css' media='screen, projection, print' rel='stylesheet' type='text/css' />
    <link rel="icon" type="image/png" href="./assets/0.13.1/favicon_green.png" />
  </head>

  <body data-branch-coverage=true>
    <div id="loading">
      <img src="./assets/0.13.1/loading.gif" alt="loading"/>
    </div>
    <div id="wrapper" class="hide">
      <div class="timestamp">Generated <abbr class="timeago" title="2025-03-29T21:44:43-04:00">2025-03-29T21:44:43-04:00</abbr></div>
      <ul class="group_tabs"></ul>

      <div id="content">
        <div class="file_list_container" id="AllFiles">
  <h2>
    <span class="group_name">All Files</span>
    (<span class="covered_percent">
      <span class="green">
  99.41%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         37.79
       </span>
    </span> hits/line
    )
  </h2>

  <a name="AllFiles"></a>

  <div>
    <b>7</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>169</b> relevant lines,
    <span class="green"><b>168</b> lines covered</span> and
    <span class="red"><b>1</b> lines missed. </span>
    (<span class="green">
  99.41%
</span>
)
  </div>

  
    <div class="t-branch-summary">
      <span><b>42</b> total branches, </span>
      <span class="green"><b>37</b> branches covered</span> and
      <span class="red"><b>5</b> branches missed.</span>
      (<span class="yellow">
  88.1%
</span>
)
    </div>
  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
            <th class="cell--number">Branch Coverage</th>
            <th class="cell--number">Branches</th>
            <th class="cell--number">Covered branches</th>
            <th class="cell--number">Missed branches </th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8137d001be5ea12349a4a4508403a687a2dbbc47" class="src_link" title="lib/type_balancer.rb">lib/type_balancer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">19</td>
            <td class="cell--number">11</td>
            <td class="cell--number">11</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.82</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ce0897950b2bdcf1e6c29d485154fedc56628e73" class="src_link" title="lib/type_balancer/balancer.rb">lib/type_balancer/balancer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">97.73 %</td>
            <td class="cell--number">92</td>
            <td class="cell--number">44</td>
            <td class="cell--number">43</td>
            <td class="cell--number">1</td>
            <td class="cell--number">59.23</td>
            
              <td class="yellow strong cell--number t-file__branch-coverage">83.33 %</td>
              <td class="cell--number">12</td>
              <td class="cell--number">10</td>
              <td class="cell--number">2</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#00f8d156952ae5820c002f9dccc85bb31646dcd1" class="src_link" title="lib/type_balancer/distribution_calculator.rb">lib/type_balancer/distribution_calculator.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">41</td>
            <td class="cell--number">21</td>
            <td class="cell--number">21</td>
            <td class="cell--number">0</td>
            <td class="cell--number">27.24</td>
            
              <td class="red strong cell--number t-file__branch-coverage">75.00 %</td>
              <td class="cell--number">4</td>
              <td class="cell--number">3</td>
              <td class="cell--number">1</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#0cf1c869e2b1e11ef200ee4a8a5c306ebdaaad2f" class="src_link" title="lib/type_balancer/gap_fillers/alternating.rb">lib/type_balancer/gap_fillers/alternating.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">55</td>
            <td class="cell--number">28</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">13.11</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">10</td>
              <td class="cell--number">10</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#24ee74351781e97a70f07d50631425f455052164" class="src_link" title="lib/type_balancer/gap_fillers/base.rb">lib/type_balancer/gap_fillers/base.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">18</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">8.14</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2e103ddd35a9c128ecf5716773e62549767388b0" class="src_link" title="lib/type_balancer/gap_fillers/sequential.rb">lib/type_balancer/gap_fillers/sequential.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">55</td>
            <td class="cell--number">28</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">74.25</td>
            
              <td class="yellow strong cell--number t-file__branch-coverage">83.33 %</td>
              <td class="cell--number">12</td>
              <td class="cell--number">10</td>
              <td class="cell--number">2</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6b225604d1b3c9f009cb93db8f77f1d2e9801009" class="src_link" title="lib/type_balancer/ordered_collection_manager.rb">lib/type_balancer/ordered_collection_manager.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">60</td>
            <td class="cell--number">30</td>
            <td class="cell--number">30</td>
            <td class="cell--number">0</td>
            <td class="cell--number">22.87</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">4</td>
              <td class="cell--number">4</td>
              <td class="cell--number">0</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>


        
          <div class="file_list_container" id="Core">
  <h2>
    <span class="group_name">Core</span>
    (<span class="covered_percent">
      <span class="green">
  99.41%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         37.79
       </span>
    </span> hits/line
    )
  </h2>

  <a name="Core"></a>

  <div>
    <b>7</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>169</b> relevant lines,
    <span class="green"><b>168</b> lines covered</span> and
    <span class="red"><b>1</b> lines missed. </span>
    (<span class="green">
  99.41%
</span>
)
  </div>

  
    <div class="t-branch-summary">
      <span><b>42</b> total branches, </span>
      <span class="green"><b>37</b> branches covered</span> and
      <span class="red"><b>5</b> branches missed.</span>
      (<span class="yellow">
  88.1%
</span>
)
    </div>
  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
            <th class="cell--number">Branch Coverage</th>
            <th class="cell--number">Branches</th>
            <th class="cell--number">Covered branches</th>
            <th class="cell--number">Missed branches </th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#8137d001be5ea12349a4a4508403a687a2dbbc47" class="src_link" title="lib/type_balancer.rb">lib/type_balancer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">19</td>
            <td class="cell--number">11</td>
            <td class="cell--number">11</td>
            <td class="cell--number">0</td>
            <td class="cell--number">1.82</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#ce0897950b2bdcf1e6c29d485154fedc56628e73" class="src_link" title="lib/type_balancer/balancer.rb">lib/type_balancer/balancer.rb</a></td>
            <td class="green strong cell--number t-file__coverage">97.73 %</td>
            <td class="cell--number">92</td>
            <td class="cell--number">44</td>
            <td class="cell--number">43</td>
            <td class="cell--number">1</td>
            <td class="cell--number">59.23</td>
            
              <td class="yellow strong cell--number t-file__branch-coverage">83.33 %</td>
              <td class="cell--number">12</td>
              <td class="cell--number">10</td>
              <td class="cell--number">2</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#00f8d156952ae5820c002f9dccc85bb31646dcd1" class="src_link" title="lib/type_balancer/distribution_calculator.rb">lib/type_balancer/distribution_calculator.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">41</td>
            <td class="cell--number">21</td>
            <td class="cell--number">21</td>
            <td class="cell--number">0</td>
            <td class="cell--number">27.24</td>
            
              <td class="red strong cell--number t-file__branch-coverage">75.00 %</td>
              <td class="cell--number">4</td>
              <td class="cell--number">3</td>
              <td class="cell--number">1</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#0cf1c869e2b1e11ef200ee4a8a5c306ebdaaad2f" class="src_link" title="lib/type_balancer/gap_fillers/alternating.rb">lib/type_balancer/gap_fillers/alternating.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">55</td>
            <td class="cell--number">28</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">13.11</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">10</td>
              <td class="cell--number">10</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#24ee74351781e97a70f07d50631425f455052164" class="src_link" title="lib/type_balancer/gap_fillers/base.rb">lib/type_balancer/gap_fillers/base.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">18</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">8.14</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2e103ddd35a9c128ecf5716773e62549767388b0" class="src_link" title="lib/type_balancer/gap_fillers/sequential.rb">lib/type_balancer/gap_fillers/sequential.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">55</td>
            <td class="cell--number">28</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">74.25</td>
            
              <td class="yellow strong cell--number t-file__branch-coverage">83.33 %</td>
              <td class="cell--number">12</td>
              <td class="cell--number">10</td>
              <td class="cell--number">2</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#6b225604d1b3c9f009cb93db8f77f1d2e9801009" class="src_link" title="lib/type_balancer/ordered_collection_manager.rb">lib/type_balancer/ordered_collection_manager.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">60</td>
            <td class="cell--number">30</td>
            <td class="cell--number">30</td>
            <td class="cell--number">0</td>
            <td class="cell--number">22.87</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">4</td>
              <td class="cell--number">4</td>
              <td class="cell--number">0</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
          <div class="file_list_container" id="GapFillers">
  <h2>
    <span class="group_name">Gap Fillers</span>
    (<span class="covered_percent">
      <span class="green">
  100.0%
</span>

     </span>
     covered at
     <span class="covered_strength">
       <span class="green">
         39.73
       </span>
    </span> hits/line
    )
  </h2>

  <a name="GapFillers"></a>

  <div>
    <b>3</b> files in total.
  </div>

  <div class="t-line-summary">
    <b>63</b> relevant lines,
    <span class="green"><b>63</b> lines covered</span> and
    <span class="red"><b>0</b> lines missed. </span>
    (<span class="green">
  100.0%
</span>
)
  </div>

  
    <div class="t-branch-summary">
      <span><b>22</b> total branches, </span>
      <span class="green"><b>20</b> branches covered</span> and
      <span class="red"><b>2</b> branches missed.</span>
      (<span class="green">
  90.91%
</span>
)
    </div>
  

  <div class="file_list--responsive">
    <table class="file_list">
      <thead>
        <tr>
          <th>File</th>
          <th class="cell--number">% covered</th>
          <th class="cell--number">Lines</th>
          <th class="cell--number">Relevant Lines</th>
          <th class="cell--number">Lines covered</th>
          <th class="cell--number">Lines missed</th>
          <th class="cell--number">Avg. Hits / Line</th>
          
            <th class="cell--number">Branch Coverage</th>
            <th class="cell--number">Branches</th>
            <th class="cell--number">Covered branches</th>
            <th class="cell--number">Missed branches </th>
          
        </tr>
      </thead>
      <tbody>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#0cf1c869e2b1e11ef200ee4a8a5c306ebdaaad2f" class="src_link" title="lib/type_balancer/gap_fillers/alternating.rb">lib/type_balancer/gap_fillers/alternating.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">55</td>
            <td class="cell--number">28</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">13.11</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">10</td>
              <td class="cell--number">10</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#24ee74351781e97a70f07d50631425f455052164" class="src_link" title="lib/type_balancer/gap_fillers/base.rb">lib/type_balancer/gap_fillers/base.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">18</td>
            <td class="cell--number">7</td>
            <td class="cell--number">7</td>
            <td class="cell--number">0</td>
            <td class="cell--number">8.14</td>
            
              <td class="green strong cell--number t-file__branch-coverage">100.00 %</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
              <td class="cell--number">0</td>
            
          </tr>
        
          <tr class="t-file">
            <td class="strong t-file__name"><a href="#2e103ddd35a9c128ecf5716773e62549767388b0" class="src_link" title="lib/type_balancer/gap_fillers/sequential.rb">lib/type_balancer/gap_fillers/sequential.rb</a></td>
            <td class="green strong cell--number t-file__coverage">100.00 %</td>
            <td class="cell--number">55</td>
            <td class="cell--number">28</td>
            <td class="cell--number">28</td>
            <td class="cell--number">0</td>
            <td class="cell--number">74.25</td>
            
              <td class="yellow strong cell--number t-file__branch-coverage">83.33 %</td>
              <td class="cell--number">12</td>
              <td class="cell--number">10</td>
              <td class="cell--number">2</td>
            
          </tr>
        
      </tbody>
    </table>
  </div>
</div>

        
      </div>

      <div id="footer">
        Generated by <a href="https://github.com/simplecov-ruby/simplecov">simplecov</a> v0.22.0
        and simplecov-html v0.13.1<br/>
        using RSpec
      </div>

      <div class="source_files">
      
        <div class="source_table" id="8137d001be5ea12349a4a4508403a687a2dbbc47">
  <div class="header">
    <h3>lib/type_balancer.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="green">
  100.0%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>11</b> relevant lines.
      <span class="green"><b>11</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>0</b> total branches, </span>
          <span class="green"><b>0</b> branches covered</span> and
          <span class="red"><b>0</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/version&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/distribution_calculator&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="5">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/ordered_collection_manager&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="6">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/gap_fillers/base&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/gap_fillers/alternating&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/gap_fillers/sequential&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">require_relative &#39;type_balancer/balancer&#39;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="11">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  class Error &lt; StandardError; end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  def self.balance(collection, type_field: :type, type_order: nil)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="15">
            
              <span class="hits">10</span>
            

            
              
            

            <code class="ruby">    Balancer.new(collection, type_field: type_field, types: type_order).call</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            
              
            

            <code class="ruby">  # Your code goes here...</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="ce0897950b2bdcf1e6c29d485154fedc56628e73">
  <div class="header">
    <h3>lib/type_balancer/balancer.rb</h3>
    <h4>
      <span class="green">
  97.73%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="yellow">
  83.33%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>44</b> relevant lines.
      <span class="green"><b>43</b> lines covered</span> and
      <span class="red"><b>1</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>12</b> total branches, </span>
          <span class="green"><b>10</b> branches covered</span> and
          <span class="red"><b>2</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            
              
            

            <code class="ruby">  # Main class responsible for balancing items in a collection based on their types.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            
              
            

            <code class="ruby">  # It uses a distribution calculator to determine optimal positions for each type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            
              
            

            <code class="ruby">  # and a gap filler strategy to place items in the final sequence.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  class Balancer</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def initialize(collection, type_field:, types: nil, distribution_calculator: DistributionCalculator.new)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="21" data-linenumber="9">
            
              <span class="hits">21</span>
            

            
              
            

            <code class="ruby">      @collection = collection</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="21" data-linenumber="10">
            
              <span class="hits">21</span>
            

            
              
            

            <code class="ruby">      @type_field = type_field</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="21" data-linenumber="11">
            
              <span class="hits">21</span>
            

            
              
            

            <code class="ruby">      @types = types || extract_unique_types</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="12">
            
              <span class="hits">20</span>
            

            
              
            

            <code class="ruby">      @distribution_calculator = distribution_calculator</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def call</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="16">
            
              <span class="hits">20</span>
            

            
              
                <span class="hits" title="then branch hit 1 times">
                  then: 1
                </span>
              
                <span class="hits" title="else branch hit 19 times">
                  else: 19
                </span>
              
            

            <code class="ruby">      return [] if @collection.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="17">
            
              <span class="hits">19</span>
            

            
              
                <span class="hits" title="then branch hit 3 times">
                  then: 3
                </span>
              
                <span class="hits" title="else branch hit 16 times">
                  else: 16
                </span>
              
            

            <code class="ruby">      return @collection if single_type?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="19">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      balance_collection</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="22">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="23">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="24">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def single_type?</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="70" data-linenumber="25">
            
              <span class="hits">70</span>
            

            
              
            

            <code class="ruby">      @types.any? { |type| items_of_type(type).size == @collection.size }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="28">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def balance_collection</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="29">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      total_count = @collection.size</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="30">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      collection_manager = OrderedCollectionManager.new(total_count)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            
              
            

            <code class="ruby">      # Place primary type (first type) at calculated positions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="33">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      primary_items = place_primary_type(collection_manager, total_count)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            
              
            

            <code class="ruby">      # Place remaining types alternating in the gaps</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="36">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      place_remaining_types(collection_manager, primary_items)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="38">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      collection_manager.result</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="41">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def place_primary_type(collection_manager, total_count)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="42">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      primary_type = @types.first</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="43">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      primary_items = items_of_type(primary_type)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="44">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="45">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      positions = @distribution_calculator.calculate_target_positions(</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            
              
            

            <code class="ruby">        total_count,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="47">
            

            
              
            

            <code class="ruby">        primary_items.size</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            
              
            

            <code class="ruby">      )</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="49">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      collection_manager.place_at_positions(primary_items.first(positions.size), positions)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            
              
            

            <code class="ruby">      # Return unused primary items for gap filling</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="52">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      primary_items[positions.size..]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="55">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def place_remaining_types(collection_manager, unused_primary_items)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="56">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      remaining_types = @types[1..]</code>
          </li>
        </div>
      
        <div>
          <li class="missed-branch" data-hits="16" data-linenumber="57">
            
              <span class="hits">16</span>
            

            
              
                <span class="hits" title="then branch hit 0 times">
                  then: 0
                </span>
              
                <span class="hits" title="else branch hit 16 times">
                  else: 16
                </span>
              
            

            <code class="ruby">      return if remaining_types.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            

            
              
            

            <code class="ruby">      # Get items for each remaining type</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="48" data-linenumber="60">
            
              <span class="hits">48</span>
            

            
              
            

            <code class="ruby">      remaining_items = remaining_types.map { |type| items_of_type(type) }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="61">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="62">
            

            
              
            

            <code class="ruby">      # Add unused primary items to the remaining items</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="63">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      all_remaining_items = [unused_primary_items, *remaining_items].compact.reject(&amp;:empty?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="64">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="65">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">      if all_remaining_items.size == 1</code>
          </li>
        </div>
      
        <div>
          <li class="missed-branch" data-hits="" data-linenumber="66">
            

            
              
                <span class="hits" title="then branch hit 0 times">
                  then: 0
                </span>
              
            

            <code class="ruby">        # If only one type of items left, fill all gaps with it</code>
          </li>
        </div>
      
        <div>
          <li class="missed" data-hits="0" data-linenumber="67">
            

            
              
            

            <code class="ruby">        collection_manager.fill_remaining_gaps([all_remaining_items.first])</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="68">
            

            
              
            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="69">
            

            
              
                <span class="hits" title="else branch hit 16 times">
                  else: 16
                </span>
              
            

            <code class="ruby">        # For two or more types, fill gaps evenly among all types</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="16" data-linenumber="70">
            
              <span class="hits">16</span>
            

            
              
            

            <code class="ruby">        collection_manager.fill_remaining_gaps(all_remaining_items)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="71">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="72">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="73">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="74">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def items_of_type(type)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="555" data-linenumber="75">
            
              <span class="hits">555</span>
            

            
              
            

            <code class="ruby">      @collection.select { |item| item_type(item) == type }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="76">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="77">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="78">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def item_type(item)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="517" data-linenumber="79">
            
              <span class="hits">517</span>
            

            
              
                <span class="hits" title="then branch hit 86 times">
                  then: 86
                </span>
              
            

            <code class="ruby">      if item.respond_to?(@type_field)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="86" data-linenumber="80">
            
              <span class="hits">86</span>
            

            
              
                <span class="hits" title="else branch hit 431 times">
                  else: 431
                </span>
              
            

            <code class="ruby">        item.send(@type_field)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="431" data-linenumber="81">
            
              <span class="hits">431</span>
            

            
              
                <span class="hits" title="then branch hit 430 times">
                  then: 430
                </span>
              
            

            <code class="ruby">      elsif item.respond_to?(:[])</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="430" data-linenumber="82">
            
              <span class="hits">430</span>
            

            
              
            

            <code class="ruby">        item[@type_field.to_s] || item[@type_field.to_sym]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="83">
            

            
              
                <span class="hits" title="else branch hit 1 times">
                  else: 1
                </span>
              
            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="84">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">        raise Error, &quot;Cannot access type field &#39;#{@type_field}&#39; on item #{item}&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="85">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="86">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="87">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="88">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def extract_unique_types</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="78" data-linenumber="89">
            
              <span class="hits">78</span>
            

            
              
            

            <code class="ruby">      @collection.map { |item| item_type(item) }.uniq</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="90">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="91">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="92">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="00f8d156952ae5820c002f9dccc85bb31646dcd1">
  <div class="header">
    <h3>lib/type_balancer/distribution_calculator.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="red">
  75.0%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>21</b> relevant lines.
      <span class="green"><b>21</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>4</b> total branches, </span>
          <span class="green"><b>3</b> branches covered</span> and
          <span class="red"><b>1</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            
              
            

            <code class="ruby">  # Calculates the optimal distribution of items by type in a sequence.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            
              
            

            <code class="ruby">  # For each type, it determines the ideal positions where items of that type</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            
              
            

            <code class="ruby">  # should be placed to achieve a balanced distribution.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  class DistributionCalculator</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def initialize(target_ratio = 0.2)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="39" data-linenumber="9">
            
              <span class="hits">39</span>
            

            
              
            

            <code class="ruby">      @target_ratio = target_ratio</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="10">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="12">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def calculate_target_positions(total_count, available_items_count)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="13">
            
              <span class="hits">36</span>
            

            
              
            

            <code class="ruby">      target_count = calculate_target_count(total_count, available_items_count)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="36" data-linenumber="14">
            
              <span class="hits">36</span>
            

            
              
                <span class="hits" title="then branch hit 3 times">
                  then: 3
                </span>
              
                <span class="hits" title="else branch hit 33 times">
                  else: 33
                </span>
              
            

            <code class="ruby">      return [] if target_count.zero?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="16">
            
              <span class="hits">33</span>
            

            
              
            

            <code class="ruby">      calculate_distributed_positions(total_count, target_count)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="19">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="20">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="21">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def calculate_target_count(total_count, available_items_count)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="22">
            
              <span class="hits">35</span>
            

            
              
            

            <code class="ruby">      target_count = (total_count * @target_ratio).ceil</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="35" data-linenumber="23">
            
              <span class="hits">35</span>
            

            
              
            

            <code class="ruby">      [target_count, available_items_count].min</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="26">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def calculate_distributed_positions(total_count, target_count)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="27">
            
              <span class="hits">33</span>
            

            
              
            

            <code class="ruby">      spacing = (total_count.to_f / target_count).ceil</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="28">
            
              <span class="hits">33</span>
            

            
              
            

            <code class="ruby">      positions = []</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="29">
            
              <span class="hits">33</span>
            

            
              
            

            <code class="ruby">      current_pos = 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="31">
            
              <span class="hits">33</span>
            

            
              
            

            <code class="ruby">      target_count.times do</code>
          </li>
        </div>
      
        <div>
          <li class="missed-branch" data-hits="62" data-linenumber="32">
            
              <span class="hits">62</span>
            

            
              
                <span class="hits" title="then branch hit 0 times">
                  then: 0
                </span>
              
                <span class="hits" title="else branch hit 62 times">
                  else: 62
                </span>
              
            

            <code class="ruby">        break if current_pos &gt;= total_count</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="33">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="62" data-linenumber="34">
            
              <span class="hits">62</span>
            

            
              
            

            <code class="ruby">        positions &lt;&lt; current_pos</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="62" data-linenumber="35">
            
              <span class="hits">62</span>
            

            
              
            

            <code class="ruby">        current_pos += spacing</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="33" data-linenumber="38">
            
              <span class="hits">33</span>
            

            
              
            

            <code class="ruby">      positions</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="39">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="0cf1c869e2b1e11ef200ee4a8a5c306ebdaaad2f">
  <div class="header">
    <h3>lib/type_balancer/gap_fillers/alternating.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="green">
  100.0%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>28</b> relevant lines.
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>10</b> total branches, </span>
          <span class="green"><b>10</b> branches covered</span> and
          <span class="red"><b>0</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  module GapFillers</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            
              
            

            <code class="ruby">    # A gap filling strategy that alternates between primary and secondary items</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            
              
            

            <code class="ruby">    # when filling empty positions in a sequence. When one type runs out,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            
              
            

            <code class="ruby">    # it continues with available items from other types.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    class Alternating &lt; Base</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def initialize(collection, primary_items, secondary_items)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="10">
            
              <span class="hits">10</span>
            

            
              
            

            <code class="ruby">        super(collection)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="11">
            
              <span class="hits">10</span>
            

            
              
            

            <code class="ruby">        @primary_items = primary_items</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="12">
            
              <span class="hits">10</span>
            

            
              
            

            <code class="ruby">        @secondary_items = secondary_items</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="14">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="15">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_gaps(positions)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="10" data-linenumber="16">
            
              <span class="hits">10</span>
            

            
              
                <span class="hits" title="then branch hit 1 times">
                  then: 1
                </span>
              
                <span class="hits" title="else branch hit 9 times">
                  else: 9
                </span>
              
            

            <code class="ruby">        return @collection if positions.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="18">
            
              <span class="hits">9</span>
            

            
              
            

            <code class="ruby">        primary_items_queue = @primary_items.dup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="19">
            
              <span class="hits">9</span>
            

            
              
            

            <code class="ruby">        secondary_items_queue = @secondary_items.dup</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="20">
            
              <span class="hits">9</span>
            

            
              
            

            <code class="ruby">        use_primary = true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="21">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="22">
            
              <span class="hits">9</span>
            

            
              
            

            <code class="ruby">        positions.each do |pos|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="48" data-linenumber="23">
            
              <span class="hits">48</span>
            

            
              
                <span class="hits" title="else branch hit 45 times">
                  else: 45
                </span>
              
                <span class="hits" title="then branch hit 3 times">
                  then: 3
                </span>
              
            

            <code class="ruby">          next unless @collection[pos].nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="45" data-linenumber="25">
            
              <span class="hits">45</span>
            

            
              
                <span class="hits" title="then branch hit 25 times">
                  then: 25
                </span>
              
            

            <code class="ruby">          @collection[pos] = if use_primary</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="26">
            
              <span class="hits">25</span>
            

            
              
            

            <code class="ruby">                               fill_with_primary_or_secondary(primary_items_queue, secondary_items_queue)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            
              
                <span class="hits" title="else branch hit 20 times">
                  else: 20
                </span>
              
            

            <code class="ruby">                             else</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="28">
            
              <span class="hits">20</span>
            

            
              
            

            <code class="ruby">                               fill_with_secondary_or_primary(secondary_items_queue, primary_items_queue)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            
              
            

            <code class="ruby">                             end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="45" data-linenumber="30">
            
              <span class="hits">45</span>
            

            
              
            

            <code class="ruby">          use_primary = !use_primary</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            
              
            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="32">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="9" data-linenumber="33">
            
              <span class="hits">9</span>
            

            
              
            

            <code class="ruby">        @collection</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="36">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="37">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="38">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_with_primary_or_secondary(primary_queue, secondary_queue)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="25" data-linenumber="39">
            
              <span class="hits">25</span>
            

            
              
                <span class="hits" title="then branch hit 6 times">
                  then: 6
                </span>
              
                <span class="hits" title="else branch hit 19 times">
                  else: 19
                </span>
              
            

            <code class="ruby">        return fill_with_available(secondary_queue) if primary_queue.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="41">
            
              <span class="hits">19</span>
            

            
              
            

            <code class="ruby">        primary_queue.shift</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_with_secondary_or_primary(secondary_queue, primary_queue)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="20" data-linenumber="45">
            
              <span class="hits">20</span>
            

            
              
                <span class="hits" title="then branch hit 6 times">
                  then: 6
                </span>
              
                <span class="hits" title="else branch hit 14 times">
                  else: 14
                </span>
              
            

            <code class="ruby">        return fill_with_available(primary_queue) if secondary_queue.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="14" data-linenumber="47">
            
              <span class="hits">14</span>
            

            
              
            

            <code class="ruby">        secondary_queue.shift</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="50">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_with_available(queue)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="12" data-linenumber="51">
            
              <span class="hits">12</span>
            

            
              
            

            <code class="ruby">        queue.shift || nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="24ee74351781e97a70f07d50631425f455052164">
  <div class="header">
    <h3>lib/type_balancer/gap_fillers/base.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="green">
  100.0%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>7</b> relevant lines.
      <span class="green"><b>7</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>0</b> total branches, </span>
          <span class="green"><b>0</b> branches covered</span> and
          <span class="red"><b>0</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  module GapFillers</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            
              
            

            <code class="ruby">    # Base class for gap filling strategies.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            
              
            

            <code class="ruby">    # Gap fillers are responsible for placing items into a sequence of positions,</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            
              
            

            <code class="ruby">    # where some positions may already be filled and others are nil (gaps).</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    class Base</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def initialize(collection)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="51" data-linenumber="10">
            
              <span class="hits">51</span>
            

            
              
            

            <code class="ruby">        @collection = collection</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="11">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="13">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_gaps(positions)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">        raise NotImplementedError, &quot;#{self.class} must implement #fill_gaps&quot;</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="17">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="2e103ddd35a9c128ecf5716773e62549767388b0">
  <div class="header">
    <h3>lib/type_balancer/gap_fillers/sequential.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="yellow">
  83.33%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>28</b> relevant lines.
      <span class="green"><b>28</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>12</b> total branches, </span>
          <span class="green"><b>10</b> branches covered</span> and
          <span class="red"><b>2</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="4">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  module GapFillers</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            
              
            

            <code class="ruby">    # A gap filling strategy that fills empty positions sequentially from</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            
              
            

            <code class="ruby">    # each array of items. It processes one type at a time, placing items</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="7">
            

            
              
            

            <code class="ruby">    # in the first available gap before moving to the next type.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    class Sequential &lt; Base</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="9">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def initialize(collection, items_arrays)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="40" data-linenumber="10">
            
              <span class="hits">40</span>
            

            
              
            

            <code class="ruby">        super(collection)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="40" data-linenumber="11">
            
              <span class="hits">40</span>
            

            
              
            

            <code class="ruby">        @items_arrays = items_arrays.compact.reject(&amp;:empty?)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_gaps(positions)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="40" data-linenumber="15">
            
              <span class="hits">40</span>
            

            
              
                <span class="hits" title="then branch hit 10 times">
                  then: 10
                </span>
              
                <span class="hits" title="else branch hit 30 times">
                  else: 30
                </span>
              
            

            <code class="ruby">        return @collection if positions.empty? || @items_arrays.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="16">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="17">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">        item_queues = @items_arrays.map(&amp;:dup)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="18">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">        current_queue_index = 0</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="20">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">        positions.each do |pos|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="139" data-linenumber="21">
            
              <span class="hits">139</span>
            

            
              
                <span class="hits" title="else branch hit 136 times">
                  else: 136
                </span>
              
                <span class="hits" title="then branch hit 3 times">
                  then: 3
                </span>
              
            

            <code class="ruby">          next unless @collection[pos].nil?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="23">
            
              <span class="hits">136</span>
            

            
              
            

            <code class="ruby">          @collection[pos] = fill_from_available_queues(item_queues, current_queue_index)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="24">
            
              <span class="hits">136</span>
            

            
              
            

            <code class="ruby">          current_queue_index = next_queue_index(current_queue_index, item_queues)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            
              
            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="26">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="27">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">        @collection</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="29">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="30">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="31">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="32">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def fill_from_available_queues(queues, start_index)</code>
          </li>
        </div>
      
        <div>
          <li class="missed-branch" data-hits="136" data-linenumber="33">
            
              <span class="hits">136</span>
            

            
              
                <span class="hits" title="then branch hit 0 times">
                  then: 0
                </span>
              
                <span class="hits" title="else branch hit 136 times">
                  else: 136
                </span>
              
            

            <code class="ruby">        return nil if queues.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="34">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="35">
            
              <span class="hits">136</span>
            

            
              
            

            <code class="ruby">        queues.size.times do |offset|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="166" data-linenumber="36">
            
              <span class="hits">166</span>
            

            
              
            

            <code class="ruby">          queue_index = (start_index + offset) % queues.size</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="166" data-linenumber="37">
            
              <span class="hits">166</span>
            

            
              
                <span class="hits" title="then branch hit 53 times">
                  then: 53
                </span>
              
                <span class="hits" title="else branch hit 113 times">
                  else: 113
                </span>
              
            

            <code class="ruby">          next if queues[queue_index].empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="38">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="113" data-linenumber="39">
            
              <span class="hits">113</span>
            

            
              
            

            <code class="ruby">          return queues[queue_index].shift</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="40">
            

            
              
            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            
              
            

            <code class="ruby">        nil</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="43">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="44">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">      def next_queue_index(current_index, queues)</code>
          </li>
        </div>
      
        <div>
          <li class="missed-branch" data-hits="136" data-linenumber="45">
            
              <span class="hits">136</span>
            

            
              
                <span class="hits" title="then branch hit 0 times">
                  then: 0
                </span>
              
                <span class="hits" title="else branch hit 136 times">
                  else: 136
                </span>
              
            

            <code class="ruby">        return 0 if queues.empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="136" data-linenumber="47">
            
              <span class="hits">136</span>
            

            
              
            

            <code class="ruby">        queues.size.times do |offset|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="192" data-linenumber="48">
            
              <span class="hits">192</span>
            

            
              
            

            <code class="ruby">          candidate_index = (current_index + 1 + offset) % queues.size</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="192" data-linenumber="49">
            
              <span class="hits">192</span>
            

            
              
                <span class="hits" title="else branch hit 103 times">
                  else: 103
                </span>
              
                <span class="hits" title="then branch hit 89 times">
                  then: 89
                </span>
              
            

            <code class="ruby">          return candidate_index unless queues[candidate_index].empty?</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="50">
            

            
              
            

            <code class="ruby">        end</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="47" data-linenumber="51">
            
              <span class="hits">47</span>
            

            
              
            

            <code class="ruby">        current_index</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="54">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
        <div class="source_table" id="6b225604d1b3c9f009cb93db8f77f1d2e9801009">
  <div class="header">
    <h3>lib/type_balancer/ordered_collection_manager.rb</h3>
    <h4>
      <span class="green">
  100.0%
</span>

      lines covered
    </h4>

    
      <h4>
        <span class="green">
  100.0%
</span>

        branches covered
      </h4>
    

    <div class="t-line-summary">
      <b>30</b> relevant lines.
      <span class="green"><b>30</b> lines covered</span> and
      <span class="red"><b>0</b> lines missed.</span>
    </div>

    
      <div class="t-branch-summary">
          <span><b>4</b> total branches, </span>
          <span class="green"><b>4</b> branches covered</span> and
          <span class="red"><b>0</b> branches missed.</span>
      </div>
    

  </div>

  <pre>
    <ol>
      
        <div>
          <li class="never" data-hits="" data-linenumber="1">
            

            
              
            

            <code class="ruby"># frozen_string_literal: true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="2">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="3">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">module TypeBalancer</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="4">
            

            
              
            

            <code class="ruby">  # Manages an ordered collection of items, providing methods to place items</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="5">
            

            
              
            

            <code class="ruby">  # at specific positions and fill gaps using different strategies.</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="6">
            

            
              
            

            <code class="ruby">  # This class acts as a facade for the gap filling functionality.</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="7">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">  class OrderedCollectionManager</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="8">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def initialize(size)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="9">
            
              <span class="hits">32</span>
            

            
              
            

            <code class="ruby">      @collection = Array.new(size)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="10">
            
              <span class="hits">32</span>
            

            
              
            

            <code class="ruby">      @original_positions = {} # Track original positions for ordering</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="11">
            
              <span class="hits">32</span>
            

            
              
            

            <code class="ruby">      @has_explicit_ordering = false # Flag to indicate if we should use original order</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="12">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="13">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="14">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def place_at_positions(items, positions)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="15">
            

            
              
            

            <code class="ruby">      # Reset original positions for this batch of items</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="16">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">      items.each_with_index do |item, i|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="58" data-linenumber="17">
            
              <span class="hits">58</span>
            

            
              
            

            <code class="ruby">        @original_positions[item] = i</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="18">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="19">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="20">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">      positions.each_with_index do |pos, i|</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="54" data-linenumber="21">
            
              <span class="hits">54</span>
            

            
              
                <span class="hits" title="then branch hit 2 times">
                  then: 2
                </span>
              
                <span class="hits" title="else branch hit 52 times">
                  else: 52
                </span>
              
            

            <code class="ruby">        break if i &gt;= items.size</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="22">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="52" data-linenumber="23">
            
              <span class="hits">52</span>
            

            
              
            

            <code class="ruby">        @collection[pos] = items[i]</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="24">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="25">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="30" data-linenumber="26">
            
              <span class="hits">30</span>
            

            
              
            

            <code class="ruby">      @has_explicit_ordering = true</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="27">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="28">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="29">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    alias place_items_at_positions place_at_positions</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="30">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="31">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def fill_gaps_alternating(primary_items, secondary_items)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="32">
            
              <span class="hits">4</span>
            

            
              
            

            <code class="ruby">      @has_explicit_ordering = false  # Gap filling should maintain position order</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="33">
            
              <span class="hits">4</span>
            

            
              
            

            <code class="ruby">      filler = GapFillers::Alternating.new(@collection, primary_items, secondary_items)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="4" data-linenumber="34">
            
              <span class="hits">4</span>
            

            
              
            

            <code class="ruby">      @collection = filler.fill_gaps(find_empty_positions)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="35">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="36">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="37">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def fill_remaining_gaps(items_arrays)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="38">
            
              <span class="hits">19</span>
            

            
              
            

            <code class="ruby">      @has_explicit_ordering = false  # Gap filling should maintain position order</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="39">
            
              <span class="hits">19</span>
            

            
              
            

            <code class="ruby">      filler = GapFillers::Sequential.new(@collection, items_arrays)</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="19" data-linenumber="40">
            
              <span class="hits">19</span>
            

            
              
            

            <code class="ruby">      @collection = filler.fill_gaps(find_empty_positions)</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="41">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="42">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="43">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def result</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="44">
            
              <span class="hits">32</span>
            

            
              
            

            <code class="ruby">      items = @collection.compact</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="32" data-linenumber="45">
            
              <span class="hits">32</span>
            

            
              
            

            <code class="ruby">      if @has_explicit_ordering</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="46">
            

            
              
                <span class="hits" title="then branch hit 8 times">
                  then: 8
                </span>
              
            

            <code class="ruby">        # Sort by original position when items were explicitly placed</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="29" data-linenumber="47">
            
              <span class="hits">29</span>
            

            
              
            

            <code class="ruby">        items.sort_by { |item| @original_positions[item] || Float::INFINITY }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="48">
            

            
              
            

            <code class="ruby">      else</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="49">
            

            
              
                <span class="hits" title="else branch hit 24 times">
                  else: 24
                </span>
              
            

            <code class="ruby">        # Return in position order for gap-filled items</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="24" data-linenumber="50">
            
              <span class="hits">24</span>
            

            
              
            

            <code class="ruby">        items</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="51">
            

            
              
            

            <code class="ruby">      end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="52">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="53">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="54">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    private</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="55">
            

            
              
            

            <code class="ruby"></code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="1" data-linenumber="56">
            
              <span class="hits">1</span>
            

            
              
            

            <code class="ruby">    def find_empty_positions</code>
          </li>
        </div>
      
        <div>
          <li class="covered" data-hits="140" data-linenumber="57">
            
              <span class="hits">140</span>
            

            
              
            

            <code class="ruby">      (0...@collection.size).reject { |i| @collection[i] }</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="58">
            

            
              
            

            <code class="ruby">    end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="59">
            

            
              
            

            <code class="ruby">  end</code>
          </li>
        </div>
      
        <div>
          <li class="never" data-hits="" data-linenumber="60">
            

            
              
            

            <code class="ruby">end</code>
          </li>
        </div>
      
    </ol>
  </pre>
</div>

      
      </div>
    </div>
  </body>
</html>
